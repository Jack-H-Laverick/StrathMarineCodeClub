
rm(list=ls())
setwd("D:/Z_Teaching and outreach/2021 Code club")

P <- as.matrix(read.csv("Sudoku.csv", header = F))

while (is.na(mean(P))) {
  
  for (i in c(1,2,3,4,5,6,7,8,9)) {

    for (j in c(1,2,3,4,5,6,7,8,9)) {
    
      if (is.na(P[i,j])) {

      r <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[i,], 0L) == 0L]
 
      c <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[,j], 0L) == 0L]
  
        if ((i-1) %/% 3 == 0 & (j-1) %/% 3 == 0)  {

          b <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[c(1,2,3),c(1,2,3)], 0L) == 0L]
    
        }
  
        if ((i-1) %/% 3 == 1 & (j-1) %/% 3 == 0)  {
    
          b <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[c(4,5,6),c(1,2,3)], 0L) == 0L]
    
        }
  
        if ((i-1) %/% 3 == 2 & (j-1) %/% 3 == 0)  {
    
          b <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[c(7,8,9),c(1,2,3)], 0L) == 0L]
    
        }
  
        if ((i-1) %/% 3 == 0 & (j-1) %/% 3 == 1)  {
    
          b <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[c(1,2,3),c(4,5,6)], 0L) == 0L]
          
        }
  
        if ((i-1) %/% 3 == 1 & (j-1) %/% 3 == 1)  {
    
          b <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[c(4,5,6),c(4,5,6)], 0L) == 0L]
    
        }
  
        if ((i-1) %/% 3 == 2 & (j-1) %/% 3 == 1)  {
    
          b <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[c(7,8,9),c(4,5,6)], 0L) == 0L]
    
        }
  
        if ((i-1) %/% 3 == 0 & (j-1) %/% 3 == 2)  {
    
          b <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[c(1,2,3),c(7,8,9)], 0L) == 0L]
    
        }
  
        if ((i-1) %/% 3 == 1 & (j-1) %/% 3 == 2)  {
    
          b <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[c(4,5,6),c(7,8,9)], 0L) == 0L]
    
        }
    
        if ((i-1) %/% 3 == 2 & (j-1) %/% 3 == 2)  {
    
          b <- c(1,2,3,4,5,6,7,8,9)[match(c(1,2,3,4,5,6,7,8,9), P[c(7,8,9),c(7,8,9)], 0L) == 0L]
    
        }

 a <- b[b %in% r[r %in% c]]

        if (length(a) == 1 ){ 
          
          if(!is.na(a)) P[i,j] <- a ; print(c(i,j))  
          
        }
      }
    }
  }  
}

for (i in c(1,2,3,4,5,6,7,8,9)) {

  print(sum(P[i,]))  
}

for (j in c(1,2,3,4,5,6,7,8,9)) {
  
  print(sum(P[,j]))  
}

Pold <- as.matrix(read.csv("Sudoku.csv", header = F))
